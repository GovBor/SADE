<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SADE - Schedule Management</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #9ca3af;
            min-height: 100vh;
        }

        .main-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 200px;
            background: #6b7280;
            color: white;
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 20px 15px;
            border-bottom: 1px solid #4b5563;
        }

        .sidebar-header h2 {
            font-size: 16px;
            font-weight: bold;
        }

        .sidebar-menu {
            flex: 1;
            padding: 10px 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
            font-size: 14px;
        }

        .menu-item:hover {
            background: #4b5563;
        }

        .menu-item.active {
            background: #374151;
        }

        .menu-item .icon {
            margin-right: 8px;
            font-size: 16px;
        }

        /* Main Content */
        .content {
            flex: 1;
            padding: 20px;
            background: #9ca3af;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            color: white;
        }

        .page-title {
            font-size: 24px;
            font-weight: bold;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .lab-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            font-size: 14px;
        }

        .lab-selector select {
            padding: 6px 10px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background: white;
            font-size: 14px;
        }

        .add-schedule-btn {
            background: #f59e0b;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
        }

        .add-schedule-btn:hover {
            background: #d97706;
        }

        /* Schedule Container */
        .schedule-container {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .schedule-header {
            margin-bottom: 15px;
            color: #333;
            font-size: 16px;
            font-weight: 500;
        }

        /* Schedule Grid */
        .schedule-grid {
            display: grid;
            grid-template-columns: 70px repeat(6, 1fr);
            gap: 1px;
            background: #e5e7eb;
            border-radius: 6px;
            overflow: hidden;
        }

        .time-slot, .day-header {
            background: #f9fafb;
            padding: 8px 6px;
            text-align: center;
            font-weight: 500;
            color: #374151;
            font-size: 12px;
        }

        .day-header {
            background: #e5e7eb;
            font-weight: 600;
            color: #1f2937;
        }

        .schedule-cell {
            background: white;
            min-height: 35px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .schedule-block {
            position: absolute;
            top: 1px;
            left: 1px;
            right: 1px;
            bottom: 1px;
            border-radius: 4px;
            padding: 6px;
            color: white;
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: center;
            line-height: 1.2;
        }

        .schedule-block:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .schedule-block.it2028 {
            background: #3b82f6;
        }

        .schedule-block.it1811 {
            background: #ef4444;
        }

        .schedule-block.database {
            background: #f59e0b;
        }

        .schedule-block.pink-white {
            background: #ec4899;
        }

        .schedule-block.capstone {
            background: #ec4899;
        }

        .course-code {
            font-weight: bold;
            margin-bottom: 1px;
        }

        .course-time {
            font-size: 9px;
            opacity: 0.9;
        }

        .system-status {
            text-align: center;
            margin-top: 15px;
            color: #666;
            font-size: 12px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            padding: 25px;
            max-width: 450px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 500;
            color: #666;
            font-size: 14px;
        }

        .detail-value {
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 8px 10px;
            border: 2px solid #e5e7eb;
            border-radius: 4px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            margin-top: 8px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .radio-item input[type="radio"] {
            width: 16px;
            height: 16px;
        }

        .radio-item label {
            font-size: 14px;
            color: #333;
        }

        .input-with-unit {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-with-unit input {
            flex: 1;
        }

        .input-unit {
            color: #666;
            font-size: 14px;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 25px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-orange {
            background: #f59e0b;
            color: white;
        }

        .btn-orange:hover {
            background: #d97706;
        }

        /* Delete Modal Specific */
        .delete-modal .modal-content {
            max-width: 350px;
            text-align: center;
        }

        .delete-message {
            margin: 20px 0;
            color: #333;
            font-size: 16px;
        }

        .delete-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>SADE System</h2>
            </div>
            <div class="sidebar-menu">
                <a href="#" class="menu-item active">
                    <span class="icon">üìÖ</span>
                    Schedules
                </a>
                <a href="#" class="menu-item">
                    <span class="icon">üìã</span>
                    Logs
                </a>
                <a href="#" class="menu-item">
                    <span class="icon">‚ö†Ô∏è</span>
                    Notification
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content">
            <div class="page-header">
                <h1 class="page-title">Schedule Management</h1>
                <div class="header-controls">
                    <div class="lab-selector">
                        <label>Select Room:</label>
                        <select id="labSelect">
                            <option value="1811">Lab 1811</option>
                            <option value="1812">Lab 1812</option>
                            <option value="1815">Lab 1815</option>
                        </select>
                    </div>
                    <button class="add-schedule-btn" onclick="openAddScheduleModal()">+ Add Schedule</button>
                </div>
            </div>

            <div class="schedule-container">
                <div class="schedule-header">
                    Viewing: Lab 1811 Schedule
                </div>

                <div class="schedule-grid">
                    <!-- Header Row -->
                    <div class="time-slot"></div>
                    <div class="day-header">Monday</div>
                    <div class="day-header">Tuesday</div>
                    <div class="day-header">Wednesday</div>
                    <div class="day-header">Thursday</div>
                    <div class="day-header">Friday</div>
                    <div class="day-header">Saturday</div>

                    <!-- Time Slots -->
                    <div class="time-slot">7:00 AM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">7:30 AM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">8:00 AM</div>
                    <div class="schedule-cell">
                        <div class="schedule-block it2028" onclick="openScheduleDetails('it2028-mon-8')">
                            <div class="course-code">IT2028 Data Structures</div>
                            <div class="course-time">8:00-9:30</div>
                        </div>
                    </div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">8:30 AM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">9:00 AM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">9:30 AM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">10:00 AM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell">
                        <div class="schedule-block it1811" onclick="openScheduleDetails('it1811-tue-10')">
                            <div class="course-code">IT1811 Programming</div>
                            <div class="course-time">10:00-11:30</div>
                        </div>
                    </div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell">
                        <div class="schedule-block pink-white" onclick="openScheduleDetails('pink-sat-10')">
                            <div class="course-code">CS101 Pink White</div>
                            <div class="course-time">10:00-12:00</div>
                        </div>
                    </div>

                    <div class="time-slot">10:30 AM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">11:00 AM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell">
                        <div class="schedule-block capstone" onclick="openScheduleDetails('capstone-thu-11')">
                            <div class="course-code">CAPSTONE</div>
                            <div class="course-time">11:30-1:00</div>
                        </div>
                    </div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">11:30 AM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">12:00 PM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell">
                        <div class="schedule-block database" onclick="openScheduleDetails('database-wed-12')">
                            <div class="course-code">DATABASE</div>
                            <div class="course-time">12:00-1:30</div>
                        </div>
                    </div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">12:30 PM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">1:00 PM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">1:30 PM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>

                    <div class="time-slot">2:00 PM</div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                    <div class="schedule-cell"></div>
                </div>

                <div class="system-status">
                    System Status: Online
                </div>
            </div>
        </div>
    </div>

    <!-- Schedule Details Modal -->
    <div id="scheduleDetailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Schedule Details</h2>
            </div>
            <div class="detail-row">
                <span class="detail-label">Lab:</span>
                <span class="detail-value" id="detailLab">Lab 1811</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Course:</span>
                <span class="detail-value" id="detailCourse">IT2028</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Course Instructor:</span>
                <span class="detail-value" id="detailInstructor">Arthur Olanda</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Date:</span>
                <span class="detail-value" id="detailDate">2023-10-16</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Time:</span>
                <span class="detail-value" id="detailTime">10:00 AM</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Duration:</span>
                <span class="detail-value" id="detailDuration">2 hours</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Grace Period:</span>
                <span class="detail-value" id="detailGrace">15 minutes</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Absences Allowed:</span>
                <span class="detail-value" id="detailAbsences">6 hours</span>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="closeModal('scheduleDetailsModal')">Save</button>
            </div>
        </div>
    </div>

    <!-- Delete Schedule Modal -->
    <div id="deleteScheduleModal" class="modal delete-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Delete Schedule</h2>
            </div>
            <p class="delete-message">Are you sure you want to delete this schedule?</p>
            <div class="delete-actions">
                <button class="btn btn-success" onclick="confirmDelete()">Yes</button>
                <button class="btn btn-danger" onclick="closeModal('deleteScheduleModal')">No</button>
            </div>
        </div>
    </div>

    <!-- Edit Schedule Modal -->
    <div id="editScheduleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Edit Schedule</h2>
            </div>
            <form id="editScheduleForm">
                <div class="form-group">
                    <label class="form-label">Course</label>
                    <input type="text" class="form-input" id="editCourse" value="IT2028">
                </div>

                <div class="form-group">
                    <label class="form-label">Laboratory Room</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" name="lab" value="1811" id="lab1811" checked>
                            <label for="lab1811">Lab 1811</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="lab" value="1812" id="lab1812">
                            <label for="lab1812">Lab 1812</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="lab" value="1815" id="lab1815">
                            <label for="lab1815">Lab 1815</label>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Start Time</label>
                        <input type="time" class="form-input" id="editStartTime" value="10:00:00">
                    </div>
                    <div class="form-group">
                        <label class="form-label">End Time</label>
                        <input type="time" class="form-input" id="editEndTime" value="12:00:00">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Day</label>
                    <select class="form-select" id="editDay">
                        <option value="monday" selected>Monday</option>
                        <option value="tuesday">Tuesday</option>
                        <option value="wednesday">Wednesday</option>
                        <option value="thursday">Thursday</option>
                        <option value="friday">Friday</option>
                        <option value="saturday">Saturday</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Duration (Hours)</label>
                    <div class="input-with-unit">
                        <input type="number" class="form-input" id="editDuration" value="1" min="1" max="8">
                        <span class="input-unit">hours</span>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Number Of Absences allowed</label>
                    <div class="input-with-unit">
                        <input type="number" class="form-input" id="editAbsences" value="6" min="0">
                        <span class="input-unit">hours</span>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Grace Period (Minutes)</label>
                    <div class="input-with-unit">
                        <input type="number" class="form-input" id="editGracePeriod" value="10" min="0" max="60">
                        <span class="input-unit">minutes</span>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('editScheduleModal')">Cancel</button>
                    <button type="submit" class="btn btn-orange">Save Schedule</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Sample schedule data
        const schedules = {
            'it2028-mon-8': {
                id: 'it2028-mon-8',
                course: 'IT2028',
                courseName: 'Data Structures',
                instructor: 'Arthur Olanda',
                lab: '1811',
                day: 'Monday',
                startTime: '08:00',
                endTime: '09:30',
                duration: 1.5,
                gracePeriod: 15,
                absencesAllowed: 6,
                substitute: null
            },
            'it1811-tue-10': {
                id: 'it1811-tue-10',
                course: 'IT1811',
                courseName: 'Programming',
                instructor: 'Prof. Smith',
                lab: '1811',
                day: 'Tuesday',
                startTime: '10:00',
                endTime: '11:30',
                duration: 1.5,
                gracePeriod: 15,
                absencesAllowed: 6,
                substitute: null
            },
            'database-wed-12': {
                id: 'database-wed-12',
                course: 'DATABASE',
                courseName: 'Database Systems',
                instructor: 'Prof. Johnson',
                lab: '1811',
                day: 'Wednesday',
                startTime: '12:00',
                endTime: '13:30',
                duration: 1.5,
                gracePeriod: 10,
                absencesAllowed: 6,
                substitute: null
            }
        };

        let currentScheduleId = null;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
        });

        function setupEventListeners() {
            // Substitute teacher toggle
            document.getElementById('enableSubstitute').addEventListener('change', function() {
                const substituteFields = document.getElementById('substituteFields');
                substituteFields.style.display = this.checked ? 'block' : 'none';
            });

            // Form submissions
            document.getElementById('editScheduleForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveScheduleChanges();
            });

            document.getElementById('addScheduleForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addNewSchedule();
            });
        }

        function openScheduleDetails(scheduleId) {
            currentScheduleId = scheduleId;
            const schedule = schedules[scheduleId];
            
            if (schedule) {
                document.getElementById('detailLab').textContent = `Lab ${schedule.lab}`;
                document.getElementById('detailCourse').textContent = schedule.course;
                document.getElementById('detailInstructor').textContent = schedule.substitute ? 
                    `${schedule.substitute.name} (Substitute for ${schedule.instructor})` : schedule.instructor;
                document.getElementById('detailDate').textContent = new Date().toISOString().split('T')[0];
                document.getElementById('detailTime').textContent = formatTime(schedule.startTime);
                document.getElementById('detailDuration').textContent = `${schedule.duration} hours`;
                document.getElementById('detailGrace').textContent = `${schedule.gracePeriod} minutes`;
                document.getElementById('detailAbsences').textContent = `${schedule.absencesAllowed} hours`;
            }
            
            showModal('scheduleDetailsModal');
        }

        function openEditScheduleModal() {
            const schedule = schedules[currentScheduleId];
            
            if (schedule) {
                document.getElementById('editCourse').value = schedule.course;
                document.getElementById('editStartTime').value = schedule.startTime;
                document.getElementById('editEndTime').value = schedule.endTime;
                document.getElementById('editDay').value = schedule.day.toLowerCase();
                document.getElementById('editDuration').value = schedule.duration;
                document.getElementById('editAbsences').value = schedule.absencesAllowed;
                document.getElementById('editGracePeriod').value = schedule.gracePeriod;
                
                // Set lab radio button
                document.getElementById(`lab${schedule.lab}`).checked = true;
                
                // Set substitute information if exists
                if (schedule.substitute) {
                    document.getElementById('enableSubstitute').checked = true;
                    document.getElementById('substituteFields').style.display = 'block';
                    document.getElementById('substituteName').value = schedule.substitute.name;
                    document.getElementById('substituteReason').value = schedule.substitute.reason;
                    document.getElementById('substituteStartDate').value = schedule.substitute.startDate;
                    document.getElementById('substituteEndDate').value = schedule.substitute.endDate;
                    document.getElementById('substituteNotes').value = schedule.substitute.notes || '';
                }
            }
            
            closeModal('scheduleDetailsModal');
            showModal('editScheduleModal');
        }

        function openAddScheduleModal() {
            showModal('addScheduleModal');
        }

        function openArchiveModal() {
            closeModal('scheduleDetailsModal');
            showModal('archiveModal');
        }

        function saveScheduleChanges() {
            const schedule = schedules[currentScheduleId];
            
            if (schedule) {
                // Update basic schedule info
                schedule.course = document.getElementById('editCourse').value;
                schedule.startTime = document.getElementById('editStartTime').value;
                schedule.endTime = document.getElementById('editEndTime').value;
                schedule.day = document.getElementById('editDay').value;
                schedule.duration = parseFloat(document.getElementById('editDuration').value);
                schedule.absencesAllowed = parseInt(document.getElementById('editAbsences').value);
                schedule.gracePeriod = parseInt(document.getElementById('editGracePeriod').value);
                
                // Update lab
                const selectedLab = document.querySelector('input[name="lab"]:checked').value;
                schedule.lab = selectedLab;
                
                // Update substitute information
                if (document.getElementById('enableSubstitute').checked) {
                    schedule.substitute = {
                        name: document.getElementById('substituteName').value,
                        reason: document.getElementById('substituteReason').value,
                        startDate: document.getElementById('substituteStartDate').value,
                        endDate: document.getElementById('substituteEndDate').value,
                        notes: document.getElementById('substituteNotes').value
                    };
                } else {
                    schedule.substitute = null;
                }
                
                alert('Schedule updated successfully!');
                closeModal('editScheduleModal');
                
                // Refresh the schedule display
                location.reload();
            }
        }

        function addNewSchedule() {
            const newSchedule = {
                id: `new-${Date.now()}`,
                course: document.getElementById('newCourse').value,
                courseName: document.getElementById('newCourseName').value,
                instructor: document.getElementById('newInstructor').value,
                lab: document.querySelector('input[name="newLab"]:checked').value,
                day: document.getElementById('newDay').value,
                startTime: document.getElementById('newStartTime').value,
                endTime: document.getElementById('newEndTime').value,
                duration: calculateDuration(document.getElementById('newStartTime').value, document.getElementById('newEndTime').value),
                gracePeriod: 15,
                absencesAllowed: 6,
                substitute: null
            };
            
            schedules[newSchedule.id] = newSchedule;
            
            alert('New schedule added successfully!');
            closeModal('addScheduleModal');
            
            // Reset form
            document.getElementById('addScheduleForm').reset();
            
            // Refresh the schedule display
            location.reload();
        }

        function confirmArchive() {
            if (currentScheduleId && schedules[currentScheduleId]) {
                // In a real application, you would move this to an archived schedules collection
                delete schedules[currentScheduleId];
                
                alert('Schedule archived successfully!');
                closeModal('archiveModal');
                
                // Refresh the schedule display
                location.reload();
            }
        }

        function showModal(modalId) {
            document.getElementById(modalId).classList.add('show');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        function formatTime(time24) {
            const [hours, minutes] = time24.split(':');
            const hour12 = hours % 12 || 12;
            const ampm = hours < 12 ? 'AM' : 'PM';
            return `${hour12}:${minutes} ${ampm}`;
        }

        function calculateDuration(startTime, endTime) {
            const start = new Date(`2000-01-01 ${startTime}`);
            const end = new Date(`2000-01-01 ${endTime}`);
            return (end - start) / (1000 * 60 * 60); // Convert to hours
        }

        // Close modals when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('show');
            }
        });
    </script>
</body>
</html>
